\documentclass[a4wide, 11pt]{article}
\usepackage{a4, fullpage}
\setlength{\parskip}{0.3cm}
\setlength{\parindent}{0cm}

% This is the preamble section where you can include extra packages etc.

\begin{document}

\title{MAlice Language Specification}

\author{Alex Rozanski and Thomas Rooney}

\date{\today}         % inserts today's date

\maketitle            % generates the title from the data above

\section{Introduction}

This is the initial language specification for the Malice language defined by the Imperial Departmnet of Computing. 

We are using a combination of Extended Backus-Naur Form (EBNF), which extends BNF by adding constructs such as repetition rules ({ and } for 0 or more occurrences and + for 1 or more occurrences.)

We are also using `ALPHA` and `DIGIT` from Augmented Backus-Naur Form (ABNF) which represent the digits 0-9 and letters A-Za-z respectively. This allows our specification to be more succinct and easier to read.

% This is an \emph{introductory comment}.
% \LaTeX\ can typeset some very complex documents, but it is also
% \textbf{quite easy to get started}.
% Try playing around with this file and see. 
% Don't worry that this page looks very spaced out,
% \LaTeX\ arranges the page for you (much less work to do than in Word!)
% so if there was more content it would close up the gaps.

% To start a new paragraph just leave a blank line.
% If you do not like numbered sections, use the \texttt{section*\{...\}}
% environment instead.


% To include maths formulas in text put them between \$ symbols like this
% $f(x) = x \times 5$.
% Or to display a formula on a line on its own you do this:
% \[
%     g(y) = y^2
% \]
\section{Types}

MAlice is a strongly typed language and supports the primitive types \texttt{number} and \texttt{letter}. The special \texttt{looking-glass} type is analagous to a \texttt{void} type as in C-style languages, and is used to denote that a function does not return a value.

The formal definition for Type:
\begin{verbatim}
  Type -> "number" | "letter"
\end{verbatim}

\section{Functions and Programs}

Our MAlice dialect supports function declarations. Functions begin with "The" followed by an optional return type, a name and a list of 0 or more parameters. The special `looking-glass` type is analagous to a void return type. Functions are declared in the global scope and cannot be nested.

The special function `hatta` is the entry point for MAlice programs and it is an error to have this function declaration omitted.

A MAlice program is comprised of 1 or more function declarations.

The formal definitions for functions and programs:

\begin{verbatim}
  Function -> "The" FunctionType Identifier ArgumentList BlockUnit

  FunctionType -> Type | "looking-glass"
  ArgumentList -> "(" [DeclarationList] ")"
  BlockUnit -> "opened" StatementList "closed"}
\end{verbatim}

\section{Statements}

Each function in MAlice is comprised 0 or more statements. Statements are separated by either a full-stop, comma or the "then" token.
  
\section{Expressions}

Expressions are defined recursively, and are only well-defined over numerical values.

\section{Variable Declarations and Assignment}

\section{Declarations}

Variable declarations follow the form:

\begin{quote}
\textbf{identifier} was a \textbf{type}
\end{quote}

Lists of variable declarations consist of single variable declarations separated by a comma. The only exception to this is the last variable declaration, which is preceded by an "and" and no comma. For example, this is a valid variable declaration list:

\begin{quote}
x was a number, y was a letter and z was a number
\end{quote}

whilst this:

\begin{quote}
x was a number, y was a letter, z was a number
\end{quote}

is not. Where there are one or more consecutive declarations of variables which share the same type, the second and later declarations can be optionally postfixed with "too", as in:

\begin{quote}
p was a letter, q was a number and r was a number too
\end{quote}

It is an error to append "too" to a declaration for a variable whose type is different to that of the previous variable declaration's type, as in:

\begin{quote}
p was a letter, q was a number too and r was a number
\end{quote}

The formal definitions for variable declaration syntax:

\begin{verbatim}
  Declaration -> Identifier "was a" Type
  DeclarationList -> Declaration [{"," Declaration ["too"]} "and" Declaration ["too"]]
\end{verbatim}

\section{Assignment}

Variable assignment is also designed to closely mirror the grammatical structure of the English language.

\section{BNF Grammar} 

Beginning here, we look at the formalized BNF Grammar. This utilises Extended BNF and the constructs defined above.

\begin{verbatim}
  Declaration -> Identifier "was a" Type
  DeclarationList -> Declaration [{"," Declaration ["too"]} "and" Declaration ["too"]]

  Assignment -> Identifier "became" Expression
  AssignmentList -> Assignment [{"and" Assignment} "but" Assignment]

  BlockUnit -> "opened" StatementList "closed"

  StatementList -> Îµ
           | Statement "."
                 | Statement Split StatementList
                 
  Statement -> DeclarationList
         | AssignmentList
         | Expression "said Alice"
         | Identifier "ate"
         | Identifier "drank"

  Split = "." | "," | "then"
 
    Term -> Identifier
        | Number
        | UnaryOperator (Term | Expression)
  Expression -> Expression BinaryOperator Term


  Program -> Function+
  Function -> "The" FunctionType Identifier ArgumentList BlockUnit

  FunctionType -> Type | "looking-glass"
  ArgumentList -> "(" [DeclarationList] ")"

  BinaryOperator -> "+" | "-" | "*" | "/" | "%"
  UnaryOperator -> "~" 

  Value -> Number | Letter
  Letter -> ALPHA
  Number -> ["-"] DIGIT+
  
  Type -> "number" | "letter"

\end{verbatim}


% \section{Semantics}

% Here is a numbered list.

% \begin{enumerate}

%     \item
%     This is item 1.
    
%     \item
%     And this is item 2.
    
% \end{enumerate}

% And here is a bulleted list.

% \begin{itemize}

%     \item
%     The parts of the list are called items here too.
    
% \end{itemize}

% Finally for this document, if you want to include a reference
% then you put it into a \texttt{thebibliography\{...\}}
% environment (see below in source file) and then 
% cite it like this \cite{lamport94}
% (you will need to run \texttt{latex} twice to get it to process the citation),
% or you can use BibTex but that is probably overkill for now.

% \begin{thebibliography}{9}

% \bibitem{lamport94}
%   Leslie Lamport,
%   \emph{\LaTeX: A Document Preparation System}.
%   Addison Wesley, Massachusetts,
%   2nd Edition,
%   1994.

% \end{thebibliography}


\end{document}
